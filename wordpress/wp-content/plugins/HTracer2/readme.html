<html>
<head>
<title>Руководство по HTracer</title>
<meta name="robots" content="noindex,nofollow" />
<meta http-equiv="Content-Type" content="text/html; charset=cp1251">

<style>
	body{margin:30px;margin-top:0px;}
	big{background-color:#F0F0F0;}
	pre{color:gray;}
	i{white-space:nowrap;color:gray;}
	ol{margin-top:0;}
	h2{margin-bottom:7px;}
	#tabs div{font-size:12pt;}
	#tabs{font-family:times New Roman; color:black;}
</style>
		<link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/base/jquery-ui.css" type="text/css" media="all" />
		<link rel="stylesheet" href="http://static.jquery.com/ui/css/demo-docs-theme/ui.theme.css" type="text/css" media="all" />
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js" type="text/javascript"></script>
		<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/jquery-ui.min.js" type="text/javascript"></script>
		<script src="http://jquery-ui.googlecode.com/svn/tags/latest/external/jquery.bgiframe-2.1.2.js" type="text/javascript"></script>
		<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/i18n/jquery-ui-i18n.min.js" type="text/javascript"></script>
</head>
<body>
<h2>Руководство</h2>
<b>Текущая версия:</b> 3.4.4<br />

<h2>Установка</h2>
<script>
	$(function() {
		$( "#tabs" ).tabs({ selected: 6 });
	});
	</script>
<div id="tabs">
	<ul>
		<li><a href="#tabs-1">WordPress</a></li>
		<li><a href="#tabs-2">DLE</a></li>
		<li><a href="#tabs-3">Joomla</a></li>
		<li><a href="#tabs-4">NetCat</a></li>
		<li><a href="#tabs-5">PHPBB</a></li>
		<li><a href="#tabs-6">Bitrix</a></li>
		<li><a href="#tabs-7">Другие движки</a></li>
	</ul>
	<div id="tabs-1">
		<br />
		Этот раздел описывает установку HTracer как плагина. 
		Если ваша версия WP младше третьей, либо вы не хотите ставить HTracer, как плагин, то смотрите вкдадку "Другие движки".<br /><br />
		<ol>
			<li>
				Скопируйте папку скрипта на сервер в папку <i>/wp-content/plugins/</i>
			</li>
			<li>	
				Поставьте права 777 на папки '<i>cash</i>', '<i>query</i>' и файлы '<i>last_refer.txt</i>' и '<i>wp_options.ini</i>'.
			</li>	
			<li>	
				Переименуйте файл <i>admin/auto_config0.php</i> в <i>admin/auto_config.php</i> и поставьте ему права 777
			</li>	
			<li>
				Зайдите в админку WP в раздел "Плагины" и активируйте плагин HTracer<br />
			</li>
			<li>
				Перейдите на страницу админки  Параметры->HTracer и настройте плагин<br />
			</li>
		</ol>
		<b>Установка облака</b><br />
		Стандартное облако можно заменить семантическим выбрав соответствующую настройку. 
		Если вы хотите использовать оба облака или ранее в вашей теме облака не было - выполните следующие действия:
		<ol>
			<li>
				Откройте папку с темой (<i>wp-content/themes/%CURENT_THEME_NAME%/</i>)
			</li>
			<li>
				Откройте один из файлов темы <small>(в некоторых шаблонах может не быть части из описываемых файлов)</small>
				<ul>
					<li>
						Вы можете вставить код в любой файл .php в этой папке. От файла и места вставки зависит где именно будет отображаться облако
					</li>
					<li>
						Если вы хотите вставить облако на вверх страницы откройте <i>header.php</i>
					</li>
					<li>
						Если вы хотите вставить облако снизу страницы откройте <i>footer.php</i>
					</li>
					<li>
						Слева или справа от страницы окройте <i>sidebar.php</i>. Если этого файла нет, то откройте <i>header.php</i> или <i>footer.php</i>
					</li>
				</ul>	
			</li>	
			<li>
				Вставьте в необходимое место <i>&lt;?php the_keys_cloud(); ?></i>
			</li>			
		 </ol>
		Чтобы настроить облако перейдите в Параметры->HTracer и перейдите по ссылке "Перейти в админку HTracer" и откройте вкладку облако		
		
		<br /><br />		
		<b>Замечания:</b>
		<ul>
			<li>
				Текстовые поля в Параметры->HTracer нужны для продвинутой настройки. В большинстве случаев достаточно настроить чекбоксы (галочки). 
			</li>
			<li>
				При установке на WP папку переименовывать не нужно.	
			</li>
			<li>
				В целях безопастности, если вы установили HTracer, как плагин, то админка HTracer откроется только после перехода из админки WP: Параметры->HTracer->"Перейти в админку HTracer".
			</li>
			<li>
				Вставка облака через комментарии (<i>&lt;!--the_keys_cloud--></i>) только в виджитах используйте PHP &mdash; <i>&lt;?php the_keys_cloud();?></i> 
			</li>
		</ul>
	</div>
	<div id="tabs-2">
		<ol>
			<li>
				Cкопируте папку HTracer в корень вашего сайта (обычно <i>public_html</i> или <i>www</i>). В целях безопасности переименуйте ее.
			</li>
			<li>
				Поставьте доступы 777 на папки '<i>cash</i>', '<i>query</i>', и файл '<i>last_refer.txt</i>'
			</li>
			<li>
				Переименуйте файл <i>admin/auto_config0.php</i> в <i>admin/auto_config.php</i> и поставьте этому файлу права 777
			</li>
			<li>
				Откройте файл <i>index.php</i> в корне сайта (обычно, <i>public_html/index.php</i> или <i>www/index.php</i>)  
			</li>
			<li>
				В следующей строке после <i>&lt;?php</i> вставьте:
				<i>include_once('ПУТЬ_К_ФАЙЛУ/HTracer.php');
				ob_start();</i> 
				<br /> Например, если вы переименовали папку HTracer в HTracer_renamed 
				<i>include_once('HTracer_renamed/HTracer.php');
				ob_start();</i>
			</li>
			<li>
				В конце файла <b>перед</b> <i>GzipOut();</i> вставьте <i>htracer_ob_end();</i> 
			</li>
			<li>
				Откройте опции HTracer (<i>http://SITE.COM/HTracer_RENAMED/admin/options.php</i>).
				Перейдите во вкладку MySQL и выставте доступы к БД и следующие настройки:
				<ul>
					<li>MySQL=Форсировать</li>  
					<li>SetNames=UTF-8</li>
				</ul>	
			</li>
		</ol>
		<b>Установка облака</b><br />
		<ol>
			<li>
				Откройте папку с шаблоном (<i>templates/%CURENT_TEMPLATE_NAME%/</i>)
			</li>
			<li>
				Откройте один из файлов шаблона <small>(в некоторых шаблонах может не быть части из описываемых файлов)</small>
				<ul>
					<li>
						Вы можете вставить код в любой файл .tpl в этой папке. От файла и места вставки зависит где именно будет отображаться облако
					</li>
					<li>
						Если вы хотите вставить семантическое облако вместо облако тегов, то, скорее всего, вам достаточно открыть <i>tagscloud.tpl</i> и вместо <i>{tags}</i> вставить <i>&lt;!--the_keys_cloud--></i>.
					</li>
					<li>
						Если вы хотите вставить облако слева или справа от страницы окройте <i>sidebar.tpl</i>.
					</li>
				</ul>	
			</li>	
			<li>
				Вставьте в необходимое место <i>&lt;!--the_keys_cloud--></i>
			</li>
		 </ol>
		Чтобы настроить облако перейдите в http://SITE.COM/HTracer_RENAMED/admin/options.php и откройте вкладку "Облако"		
		<br /><br />	
		<b>Установка контекстных ссылок</b><br />
		<ol>
			<li>
				Откройте папку с шаблоном (<i>templates/%CURENT_TEMPLATE_NAME%/</i>)
			</li>
			<li>
				Откройте файл <i>fullstory.tpl</i>
			</li>
			<li>
				Замените <i>{full-story}</i> на <i>&lt;!--htracer_context_links-->{full-story}&lt;!--/htracer_context_links--></i> 
			</li>
			<li>
				Перейдите в http://SITE.COM/HTracer_RENAMED/admin/options.php, откройте вкладку "Вставка" и задайте "Вставлять контекстные ссылки"="В диапозоне"
			</li>
		 </ol>
	</div>
	<div id="tabs-3">
		<ol>
			<li>
				Cкопируте папку HTracer в корень вашего сайта (обычно <i>public_html</i> или <i>www</i>). В целях безопасности переименуйте ее.
			</li>
			<li>
				Поставьте доступы 777 на папки '<i>cash</i>', '<i>query</i>', и файл '<i>last_refer.txt</i>'
			</li>
			<li>
				Переименуйте файл <i>admin/auto_config0.php</i> в <i>admin/auto_config.php</i> и поставьте этому файлу права 777
			</li>
			<li>Отключите gzip сжатие в Joomla. Переменная gzip в файле configuration.php должна быть равна 0</li>
			<li>Откройте файл index.php в корне сайта (например, <i>public_html/index.php</i> или <i>www/index.php</i>)</li>
			<li>В самое начало index.php файла вставьте <i>&lt?php include_once('HTracer_Renamed/HTracer.php');?></i> 
			Вместо HTracer_Renamed укажите папку в которую вы переименовали папку HTracer.
			Рядом с этим кодом не должно быть пробелов и энтеров</li>
			<li>Найдите в этом файле строку <i>echo JResponse::toString($mainframe->getCfg('gzip'));</i> и замените ее на<pre>
	ob_start();
	echo JResponse::toString($mainframe->getCfg('gzip'));
	htracer_ob_end();</pre>
			</li>
			<li>
				Откройте опции HTracer (<i>http://SITE.COM/HTracer_RENAMED/admin/options.php</i>).
				Перейдите во вкладку MySQL и выставте доступы к БД и задайте следующие настройки
				<ul>
					<li>MySQL=Форсировать</li>  
					<li>SetNames=UTF-8</li>
				</ul>	
			</li>
		</ol><br />
		
		
		Для более старых вырсий Joomla в которых нет <i>echo JResponse::toString($mainframe->getCfg('gzip'));</i>
		но есть <i>echo $app;</i> замените эту строку на <i>ob_start();echo $app;htracer_ob_end();</i><br /><br />
		

		<b>Установка облака</b><br />
		<ol>
			<li>
				Откройте файл <i>templates/%CURENT_TEMPLATE_NAME%/index.php</i>
			</li>
			<li>
				Вставьте в необходимое место <i>&lt;!--the_keys_cloud--></i>
			</li>
			<li>
				Чтобы настроить облако перейдите в http://SITE.COM/HTracer_RENAMED/admin/options.php и откройте вкладку "Облако"
			</li>
		</ol>
	
		<b>Установка контекстных ссылок</b><br />
		<ol>
			<li>
				Откройте файл <i>templates/%CURENT_TEMPLATE_NAME%/index.php</i>
			</li>
			<li>
				Замените <i>&lt;jdoc:include type="component" /></i> на <i>&lt;!--htracer_context_links-->&lt;jdoc:include type="component" />&lt;!--/htracer_context_links--></i> 
			</li>
			<li>
				Перейдите в http://SITE.COM/HTracer_RENAMED/admin/options.php, откройте вкладку "Вставка" и задайте "Вставлять контекстные ссылки"="В диапозоне"
			</li>
		 </ol>
		
		
		
		 
	</div>
	<div id="tabs-4">
	  <ol>
			<li>
				Cкопируте папку HTracer в корень вашего сайта (обычно <i>public_html</i> или <i>www</i>). В целях безопасности переименуйте ее.
			</li>
			<li>
				Поставьте доступы 777 на папки '<i>cash</i>', '<i>query</i>', и файл '<i>last_refer.txt</i>'
			</li>
			<li>
				Переименуйте файл <i>admin/auto_config0.php</i> в <i>admin/auto_config.php</i> и поставьте этому файлу права 777
			</li>
			<li>
				Откройте опции HTracer (<i>http://SITE.COM/HTracer_RENAMED/admin/options.php</i>).
				Перейдите во вкладку MySQL и выставте доступы к БД и следующие настройки:
				<ul>
					<li>MySQL=Форсировать</li>  
					<li>SetNames=UTF-8</li>
				</ul>	
				<i>Если вы не знаете доступы к MySQL посмотрите их в файле vars.inc.php в корне сайта</i>
			</li>
			<li>
				Откройте файл <i>netcat/require/e404.php</i>. 
			</li>
			<li> Вставьте следующий код в <b>самое начало</b> этого файла:<br />
				<textarea spellcheck='false' style='width:700px;height: 100px;font-size:10pt;'>&lt;?php //> 
	/*Этот код составляет путь к HTracer.php*/
		$mht_dn= explode('/',dirname(__FILE__));
		unset($mht_dn[count($mht_dn)-1]);
		unset($mht_dn[count($mht_dn)-1]);
	/*Подключаем HTracer.php*/	
		include_once(JOIN('/',$mht_dn).'/HTracer_renamed/HTracer.php');
	/*Добавляем фильтр на вывод HTML*/		
		htracer_start();
?></textarea><br />
				Вместо HTracer_renamed впишите имя папки в которую вы переименовали папку HTracer.
			</li>
			<li>
				В конец этого файла ПЕРЕД <i>?></i> вставьте <i>hkey_connect_to_mysql(true);</i>
			</li> 
	</ol>
	<b>Установка облака</b><br />
		<ol>
			<li>
				Перейдите в админку NetCat.
			</li>
			<li>
				Перейдите в Разработка->Макеты Дизайна и выберите необходимый макет				
			</li>
			<li>
				Вставьте в необходимое место макета <i>&lt;!--the_keys_cloud--></i>
			</li>
			<li>
				Чтобы настроить облако перейдите в http://SITE.COM/HTracer_RENAMED/admin/options.php и откройте вкладку "Облако"
			</li>
		</ol>
		<b>Установка контекстных ссылок</b><br />
		<ol>
			<li>
				Перейдите в админку NetCat.
			</li>
			<li>
				Перейдите в Разработка->Макеты Дизайна и выберите необходимый макет				
			</li>
			<li>
				В конец поля ввода текста с названием "Верхняя часть страницы (Header):" вставьте &lt;!--htracer_context_links-->
			</li>
			<li>
				В начало поля ввода текста с названием "Нижняя часть страницы (Footer):" вставьте &lt;!--/htracer_context_links-->	
			</li>
			<li>
				Перейдите в http://SITE.COM/HTracer_RENAMED/admin/options.php, откройте вкладку "Вставка" и задайте "Вставлять контекстные ссылки"="В диапозоне"
			</li>
		 </ol>

    </div>
		<div id="tabs-5">
		<ol>
			<li>
				Cкопируте папку HTracer в корень вашего сайта (обычно <i>public_html</i> или <i>www</i>). В целях безопасности переименуйте ее.
			</li>
			<li>
				Поставьте доступы 777 на папки '<i>cash</i>', '<i>query</i>', и файл '<i>last_refer.txt</i>'
			</li>
			<li>
				Переименуйте файл <i>admin/auto_config0.php</i> в <i>admin/auto_config.php</i> и поставьте этому файлу права 777
			</li>
			<li>
				Откройте опции HTracer (<i>http://SITE.COM/HTracer_RENAMED/admin/options.php</i>).
				Перейдите во вкладку MySQL и выставте доступы к БД и следующие настройки:
				<ul>
					<li>MySQL=Форсировать</li>  
					<li>SetNames=UTF-8</li>
				</ul>	
			</li>	
			<li>
				Откройте файл <i>includes/functions.php</i> 
			</li>	
			<li>Вставьте следующий код <b>в самое начало</b> файла index.php:
				<BR />
				<textarea spellcheck='false' style='width:700px;height: 100px;font-size:10pt;'>&lt;?php /*>*/ 
	global $phpbb_root_path;
	include_once($phpbb_root_path.'/HTracer_Renamed/HTracer.php'); 
?></textarea>
				<BR />
				Вместо HTracer_renamed укажите папку в которую вы переименовали папку HTracer.
			</li>
			<li>
				В функции page_footer замените стоку <i>$template->display('body');</i> на 
				<BR />
				<textarea spellcheck='false' style='width:700px;height: 75px;font-size:10pt;'>
	ob_start();
	$template->display('body');
	htracer_ob_end(); 
				</textarea>
<BR />
		
			</li>	
		</ol>
	</div> 	
	<div id="tabs-6">
		<ol>
			<li>
				Отключите gzip сжатие в Bitrix (отключите модуль компрессии).  При необходимости вы можете воспользоваться сжатием на уровне апач - пишите в суппорт хостинга.
			</li>
			<li>
				Cкопируте папку HTracer в корень вашего сайта (обычно <i>public_html</i> или <i>www</i>). В целях безопасности переименуйте ее.
			</li>
			<li>	
				Поставьте права 777 на папки '<i>cash</i>', '<i>query</i>' и файлы '<i>last_refer.txt</i>' и '<i>wp_options.ini</i>'.
			</li>	
			<li>	
				Переименуйте файл <i>admin/auto_config0.php</i> в <i>admin/auto_config.php</i> и поставьте ему права 777
			</li>	
			<li>
				Откройте опции HTracer (<i>http://SITE.COM/HTracer_RENAMED/admin/options.php</i>).
				Перейдите во вкладку MySQL и выставте доступы к БД и следующие настройки:
				<ul>
					<li>MySQL=Форсировать</li>  
					<li>SetNames=UTF-8</li>
				</ul>	
			</li>
			<li>
				Откройте файл <i>bitrix/php_interface/dbconn.php</i> 
			</li>
			<li>
				Вставьте следующий код <b>в самое начало</b> этого файла:
				<BR />
				<textarea spellcheck='false' style='width:700px;height: 100px;font-size:10pt;'>&lt;?php /*>*/ 
	include_once($_SERVER["DOCUMENT_ROOT"].'/HTracer_RENAMED/HTracer.php');
	htracer_start();
?></textarea>
				<BR />
				Вместо HTracer_renamed укажите папку в которую вы переименовали папку HTracer.
			</li>
		</ol>

	<b>Установка облака</b><br />
		<ol>
			<li>
				Откройте папку <i>bitrix\templates\CURENT_TEMPLATE_NAME</i>
			</li>
			<li>
				В зависимости от места, где вы хотите чтобы отображалось облако откройте либо header.php (верхняя часть страницы) footer.php(нижняя часть страницы)
			</li>
			<li>
				Вставьте в необходимое место <i>&lt;!--the_keys_cloud--></i>
			</li>
			<li>
				Чтобы настроить облако перейдите в http://SITE.COM/HTracer_RENAMED/admin/options.php и откройте вкладку "Облако"
			</li>
		</ol>
		<b>Установка контекстных ссылок</b><br />
		<ol>
			<li>
				Откройте папку <i>bitrix\templates\CURENT_TEMPLATE_NAME</i>
			</li>
			<li>
				В конец файла  Header.php вставьте &lt;!--htracer_context_links-->
			</li>
			<li>
				В файле Footer.php после <i>IncludeTemplateLangFile(__FILE__); <b>?></b></i> вставьте <i>&lt;!--/htracer_context_links--></i>
			</li>
			<li>
				Перейдите в http://SITE.COM/HTracer_RENAMED/admin/options.php, откройте вкладку "Вставка" и задайте "Вставлять контекстные ссылки"="В диапозоне"
			</li>
		 </ol>
		 
	</div>
	<div id="tabs-7">
		<ol>
			<li>
				Cкопируте папку HTracer в корень вашего сайта (обычно <i>public_html</i> или <i>www</i>). В целях безопасности переименуйте ее.
			</li>
			<li>
				Поставьте доступы 777 на папки '<i>cash</i>', '<i>query</i>', и файл '<i>last_refer.txt</i>'
			</li>
			<li>
				Переименуйте файл <i>admin/auto_config0.php</i> в <i>admin/auto_config.php</i> и поставьте этому файлу права 777
			</li>
			<li>
				Откройте опции HTracer (<i>http://SITE.COM/HTracer_RENAMED/admin/options.php</i>).
				Перейдите во вкладку MySQL и выставте доступы к БД и следующие настройки:
				<ul>
					<li>MySQL=Форсировать</li>  
					<li>SetNames=UTF-8</li>
				</ul>	
			</li>	
			<li>
				Откройте файл <i>index.php</i> в корне сайта (обычно, <i>public_html/index.php</i> или <i>www/index.php</i>).  
				Если index.php зендирован (там абракадабра и написано This is Zend File), то нажмите <a href="#index_zend">сюда</a> 
			</li>	
			<li>Вставьте следующий код <b>в самое начало</b> файла index.php:
<BR />
<textarea spellcheck='false' style='width:700px;height: 100px;font-size:10pt;'>&lt;?php /*>*/ 
	include_once('HTracer_renamed/HTracer.php'); /*Подключаем функции*/
	htracer_start(); /*Добавляем фильтр на выводимый HTML*/
?></textarea>
<BR />
				Вместо HTracer_renamed укажите папку в которую вы переименовали папку HTracer.
			</li>
		</ol>
				<br />
				<hr />
				<br />
				<h3>При возникновении ошибок</h3>
				<ul>
					<li><b>В настройках CMS отключите GZIP сжатие</b><br />
						Если вы не знаете как это сделать - поищите в Google "Как отключить GZIP сжатие в ВАШЕЙ CMS"<br />
					</li>
					<li><b>Проверьте правильность пути к HTracer.php</b><br />
						Путь, обычно, <b>не</b> начинается со слеша.<br />
						Проверьте регистр букв.<br />
						Попробуйте использовать код: <i>include_once(dirname(__FILE__).'/HTracer_renamed/HTracer.php');</i> или <i>include_once($_SERVER["DOCUMENT_ROOT"].'/HTracer_RENAMED/HTracer.php');</i> Вместо, HTracer_renamed нужно вписать папку в которую вы переименовали папку HTracer.<br />
					</li>
					<li><b>Перенесите <i>htracer_start();</i> в место перед выводом HTML</b><br />
						Например, если ваш движок работает на шаблонах 'smarty', то он выводит HTML в строке вроде <i>$smarty->display("index.tpl.html");</i><br />
						<pre>
	htracer_start();
	$smarty->display("index.tpl.html");
						</pre>
						Если и этот код не будет работать, 
						то вместо <i>htracer_start();</i> напишите <i>ob_start();</i> 
						А после вывода HTML движком напишите <i>htracer_ob_end();</i> Например: 	
						<pre>
	ob_start();
	$smarty->display("index.tpl.html");
	htracer_ob_end();
						</pre>
						Вывод не обязательно осуществляеться в одну строку. Чтобы найти его попытайтесь поискать строки, которые начинаються с оператора 'echo' или 'print' в файле index.php.
					</li>
			<li><b>Используйте альтарнативные места подключения HTracer</b></li>
				</ul>
				<br />
				<hr />
				<br />

				<h3>Альтернативные места подключения:</h3>
				Если возникнут проблемы, попробуйте его установить код подключения HTracer в одно из этих мест (перед этим удалите код подключения из HTracer из index.php).<br />
				<ul>
					<li>
						<a name="index_zend"></a>
						Если файл index.php зендирован. 
						(там абракодабра и написано "This is ZEND file"). 
						То найдите php файл, который не зендирован, но всегда выполняется и пропишите код подключения HTracer там.<br />
						Например, подойдет тот файл в котором вы прописывали доступы к MySQL во время установки PHP. 
						(почти всегда он находиться в корне сайта и в его имени содержиться "config"). Для HostCMS подойдет MainClasses.php.
					</li>	
					<li>
						Перед выводом тега HTML или HEAD в соответствующем файле шаблона (обычно Header.php).<br />
					</li>
					<li>
						Либо поищите в Google "как установить код SAPE в ВАШ_ДВИЖОК" и действуйте по аналогии
					</li>	
				</ul>
				<br />
	</div>
</div>
<h2>Поддомены или многосайтовая CMS</h2>
Возникают случаи, когда HTracer необходимо установить на многосайтовую CMS или CMS генерирующую несколько субдоменов.
Имееться ввиду что за все эти сайты или поддомены отвечает один и тот-же код CMS. И при этом сайты эти не являються заркалами. В противном случае допонительных действий производить не нужно.
<br /><br />
Есть два варианта. Первый из них установка префиксов в этом случае настройки у всех сайтов будут одинаковыми, но семантические ядра разными.
Второй вариант использование нескольких папок в этом случае и настройки и семантчические ядра у сайтов будут разными.
<br /><br />
<b>Префиксы</b><br />
В этом варианте у сайтов одинаковые настройки HTracer. Перед кодом установки напишите 
<i>&lt;?php $GLOBALS['htracer_mysql_prefix'] = str_replace('.','_',$_SERVER['SERVER_NAME']); ?></i>
Чтобы отредактировать ключевики для сайта sd1.site.ru вам нужно вписать в админке префикс таблиц = sd1_site_ru
<br /><br />
<b>Папки</b><br />
В этом варианте у сайтов разные настройки HTracer. В коде установки вместо <i>include_once('/HTracer_renamed/HTracer.php');</i>
напишите <pre>
	$hip_path=dirname(__FILE__).'/HTracer_renamed/'.str_replace('.','_',$_SERVER['SERVER_NAME']).'/HTracer.php';
	if(file_exists($hip_path))
		include_once($hip_path);
</pre>
Вместо HTracer_renamed укажите папку в которую вы переименовали папку HTracer.
В этой папке для каждого домена нужно создавать свою подпапку. 
Например для для сайта sd1.site.ru вам нужно создать папку sd1_site_ru. 
И в этой папке разместить содержимое папки с HTracer.
Потом перейти на http://site.ru/HTracer_renamed/sd1_site_ru/ и вписать уникальный префикс таблиц.

  

<br />







<h2>Установка облака</h2>
Облако можно установить двумя способами. Первый из них -- вставить код в нужное место шаблона движка.
Однако, начиная с версии 3.1.2 появилась возможность использовать css-селекторы, которая позволяет устанавливать облако без изменений файлов шаблона.
<h3>Способ 1: CSS-cелекторы</h3>
Благодаря этому методу, вы можете не изменяя файлов шаблонов движка (и даже не зная где они находяться) 
вставить в нужное вам место сайта облако. 
Однако этот способ требует от пользователя некоторых знаний в веб-разработке. 
Если вы не знаете как посмотреть исходный код страницы в браузере или не владеете css и html,
то используйте другой способ.<br /><br />
<ol>
	<li>Перейдите на страницу http://YouSite.com/HTracer_Renamed/admin/options.php
		и откройте вкладку "Облако"
	</li>
	<li>
		Обратите внимание на поле СSS-селектор.
		Например, если вы хотите вставить облако в тег с id='sidebar', напишите "#sidebar". 
		Также поддерживаются другие селекторы (для вызова справки кликниете по надписе "СSS-селектор") 
	</li>
	<li>
		Теперь вам нужно определить селектор для вставки кода.
		Для этого нужно найти самый близкий тег с заданным id, и дальше плясать от него.
		<ul>
			<li>
				В Firefox выделите часть текста на сайте перед и/или после того места, куда вы собираетесь вставить облако
				и нажмите просмотр исходного кода страницы и найдите элемент с заданным id. 
			</li>
			<li>
				В Google Chrome наведите курсор мыши на необходимое место, 
				нажмите правой кнопкой мыши и из контекстного меню выберите "Просмотр кода элемента"
			</li>
			<li>
				Если вы используете FireBug, то поступайте по аналогиии с Google Chrome, только пункт контекстного меню называеться "Анализировать элемент".
			</li>
			<li>
				Для других случаев. Откройте исходный код страницы и найдите необходимое место и ближайщий элемент с заданным id. 
			</li>
		</ul>
	</li>
	<li>
		Если вы хотите добавить текст или html-код до и/или после облака выберите "показать все опции" и во вкладке "Облако" обратите внимание на поля "HTML перед" и "HTML после".
	</li>
</ol>
<br />
<h3>Способ 2: Вставка кода</h3>
<ol>
	<li>Вставьте в необходимое место в шаблоне сайта <i>&lt;!--the_keys_cloud--></i></li>
	<li>
		Если появиться ошибка <i>"Parse error: syntax error, unexpected '<'"</i> то вместо
		<i>&lt;!--the_keys_cloud--></i> напишите <i>echo "&lt;!--the_keys_cloud-->";</i>
	</li>
	<li>Перейдите на страницу http://YouSite.com/HTracer_Renamed/admin/options.php, откройте вкладку "Облако" и настройте его</i></li>
 </ol>

<b>Если вы это не знаете куда вставлять код облака. Есть несколько способов узнать это:</b>
	<ul>
		<li>Обычно в админке CMS есть редактор шаблонов/тем оформление сайта. Иногда он называется "редактор дизайна сайта".</li>	
		<li>Перейдите на страницу http://YouSite.com/HTracer_Renamed/admin/get_template_path.php и HTracer попытается определить где находяться темы.</li>	
		<li>Наберите в Гугл "НАЗВАНИЕ_ВАШЕЙ_CMS где лежат шаблоны".</li>	
		<li>Поищите на фтп в корне сайта директорию 'themes' или 'templates'</li>	
	</ul>
Если вы нашли директорию, то необходимый вам файл, скорее всего, имеет расширение php, tmp, htm или html.
Если вы хотите вставить облако в верхнюю часть страницы, то ищите файл с именем "head" или "header",
если снизу, то "footer", если сбоку, то sidebar. В некоторых движках шаблоны не делятся на части и имеют имя main или index.


<h2>Обновление</h2>
Чтобы обновить скрипт нужно просто переписать файлы на сервере.<br />
Чтобы обновление немедленно подействовало, нужно отчистить кеш HTracer (удалить содержимое папки 'cash').<br />
Структура БД при обновленях не меняется, удалять переходы не нужно.<br />

<br />

<h2>Возможные ошибки</h2>
<ul>
	<li>
		При сохранении опций возникает ошибка, что не может создать файл "auto_config.php" или опции не сохраняются<br />
		<ol>
			<li>Переименуйте admin/auto_config0.php в admin/auto_config.php</li>
			<li>Поставьте доступы к файлу admin/auto_config.php 777</li>
			<li>Если это не помогло, попросите суппорт хостинга выключить SafeMode</li>
		</ol>	
	</li>
	<li>
		При сохранении опций возникает ошибка, что не может изменить файл "auto_config.php"<br />
		<ol>
			<li>Поставьте доступы к файлу admin/auto_config.php 777</li>
			<li>Если это не помогло, попросите суппорт хостинга выключить SafeMode</li>
		</ol>
	</li>
	<li>
		При сохранении опций в WordPress возникает ошибка, что не может изменить файл "wp_options.ini"<br />
		<ol>
			<li>Убедитесь, что доступы к файлу admin/auto_config.php 777</li>
			<li>Если это не помогло, попросите суппорт хостинга выключить SafeMode</li>
		</ol>	
	</li>
</ul>


<h2>Проверка установки</h2>
<ol>
	<li>
		<b>Откройте любую страницу вашего сайта.</b> Если страница выглядет так-же как и раньше, то все ОК.
		<ul>
			<li>
				Если выводиться код подключения (include_once() ... htracer_start()):
				<ul>		
					<li>Вставьте код подключения Htracer в другое место</li>
					<li>Поищите в Google "как выполнить php в шаблоне ВАШЕГО_ДВИЖКА"</li>
				</ul>
			</li>
			<li>
				Если выводиться ошибка вроде "file not found ... include_once" или пустая страница:
				<ul>		
					<li>Убедитесь, что вы правильно указали путь к файлу в include_once('ПУТЬ_К_ФАЙЛУ/HTracer.php');</li>
				</ul>
				<ul>		
					<li>Попытайтесь отключить GZIP сжатие в настройках вашей CMS</li>
				</ul>
			</li>
			<li>
				Если выводиться ошибка "headers was alredy sent":
				<ul>		
					<li>Удалите все пробелы, табуляции и ентеры, стоящие рядом с кодом подключения HTracer </li>
					<li>Откройте исходный код страницы. 
						Если в самом начале вы видете несколько каких-то непонятных системных символов, 
						то сохраняйте файл в который вы вставили код подключения HTracer в кодировке UFT-8 без BOM. 
						Если в вашем текстовом редакторе нет такой опции - используйте другой.</li>
				</ul>
			</li>
			<li>
				Если выводиться ошибка вроде "MySQL Error: Access Denied":
				<ul>		
					<li>Вставьте код подключения HTracer в другое место</li>
					<li>Или включите форсирование MySQL. Если не помогло проверьте доступы к MySQL в настройках скрипта.</li>
					<li>Попробуйте опцию игнорировать MySQL ping</li>
					<li>Убедитесь, что HTracer и сайт стоит на одной БД</li>
					<li>Или выключите MySQL в настройках HTracer</li>
				</ul>
			</li>
		</ul>
	</li>
	<li>
		<b>Включите опцию "Включить тестирование"</b> и поищите в исходном коде страницы вашего сайта "HTracer_Test Тест". Если вы найдете строку, то все ОК.
		<ul>
			<li>
				Если не найдете:
				<ul>		
					<li>Если движок сайта Joomla, то проверьте несколько страниц</li>
					<li>Поищите Chislo vstavok=, Если оно равно 0/0 значит некуда вставлять. 
						Включите перезапись альтов, титлов или метакейвордс</i>.
					</li>					
					<li>Убедитесь в том, что есть теги A без атрибута title или IMG без атрибута alt</li>
					<li>Вставьте код подключения Htracer в другое место</li>
				</ul>
			</li>
			<li>
				Если строка имеет вид "HTracer_Test С‚РµСЃС":
				<ul>		
					<li>Поменяйте в опциях HTracer кодировку</li>
				</ul>
			</li>
		</ul>
	</li>	
	<li>
		<b>Перейдите на страницу вашего сайт по ссылке с выдачи поисковика</b>. Если сайт не выдаст ошибок, то все ОК.
		<ul>
			<li>
				Если возникает ошибка вроде "не могу изменить файл last_refer.txt":
				<ul>		
					<li>Убедитесь что доступы к этому файлу 777</li>
					<li>Если это не помогло напишите суппорту хостинга выключить SafeMode</li>
				</ul>
			</li>
		</ul>
	</li>	
</ol>

<h2>Старт</h2>
Для того чтобы скрипт начал работать в полную силу, 
необходимо чтобы в его БД была информация о достаточном числе переходов c поисковых систем.
Можно, конечно, подождать некоторое время. 
Однако, существуют несколько вариантов быстрого старта: 
<ul>
	<li>
		Зайдите на страницу Ключи админки HTracer (Обычно, http://SITE.RU/HTracer_RENAMED/admin/keys.php) 
	</li>	
	<li>
		Пролистайте страницу до заголовка "Действия" и выберите вкладку "Экспорт из Google Ananalitics", либо "Экспорт".
	</li>
	<li>
		Если у вас сайт новый или нет статистики, то вы можете использовать <a href="http://htracer.ru/keysyn2/1step.php">утилиту для построения семантического ядра</a>, которая поможет за полчаса создать большое семантическое ядро. 
	</li>	
</ul>
Если ваш сайт не англоязычный, то перед этими вариантами, советую несколько раз перейти с поисковиков самостоятельно на ваш сайт по запросам содержащим русские слова.<br /> 
Это нужно чтобы скрипт смог опредлить внутреннюю стандартную кодировку MySQL (хотя в 90% этого не требуется).
<br />
<br />
<hr />

<h2>Остальной текст необязателен для прочтения.</h2>
<br />Автоматически не прописываються только две функции: 
<br /> 1. <a href="#key_cloud">Облако кейвордов</a>
<br /> 2. <a href="#seo_title">Генерация титла</a>
<br /> 3. Поисковые подсказки см. файл ajax_hints_sample.php
<br /><br />

<h2>API</h2>
Существуют следующие функции API:
<ul>
	<li>
		bool htracer_api_is_correct_query($query) - проверяет правильный ли ключевик перед добавлением БД. Неправильные ключевики не добавляются.
	</li>	
	<li>
		string htracer_api_query_post_filter($query) - Изменяет ключевик при санитаризации его. При выводе на сайте. В админке не действует.
	</li>	
	<li>
		string htracer_api_query_pre_filter($query) - Изменяет ключевик при добавлении в БД. Лучше использовать htracer_api_query_post_filter.
	</li>	
	<li>
		string htracer_api_cloud_filter($Res,$params) - фильтр на облако. Первый параметр результат строка, второй ассоциативный массив с параметрами
	</li>	
	<li>
		int htracer_api_weight_filter($weight,$Query,$is_first_serp_page,$SerchEngine,$HTTP_Referer) - Фильтр на вес перехода с поисковых систем.
	</li>	
</ul>
Просто объявите функцию перед кодом подключения HTracer. Например:<br />
<pre>
function htracer_api_is_correct_query($query)
{// запрещаем добавлять запросы содержащие подстроку секс
	if(strpos($query,'секс'))
		return false;
	return true;
}
function htracer_api_query_post_filter($query)
{
//	Переводит первую букву слова мухосранск* в верхний регистр (Мухосранск)
	$query=str_replace(' мухосранск', ' Мухосранск', ' '.$query);
	return trim($query);
}
</pre>
<br />
<h2>Глобальные переменные</h2>
Эти переменные служат для настройки HTracer, при невозможности конфигурирования через админку.<br />
Эти параметры должны задаваться перед include_once('Путь/HTracer.php'). Например так:<br />
<pre>
	$GLOBALS['htracer_test']=true; // Включить режим тестирования
	$GLOBALS['htracer_doubles_not_first_serp_page']=true; // Удваивать вес переходов не с первой страницы
	include_once('Путь/HTracer.php');
</pre>
 
<ul>
	<li><b>$GLOBALS['htracer_test']</b>      	&mdash; параметр для тестирования. По умолчанию не задан. Если этот параметр включен (<i> &lt;?php $GLOBALS['htracer_test']=true;?&gt;</i>), будет отключено кеширование и все фунции, кроме вывода облака и расстановки контекстных ссылок, в случает отсутствия ключевика, будут возврашать вместо пустой строки, строку "Htracer_Test Тест". Функция insert_keywords производит вставку ключевиков во всех допустимых настройками местах, и к результату сначала добавляет число замен.</li>
	<li><b>$GLOBALS['htracer_encoding']</b>  	&mdash; кодировка в которой скрипт возвращает результат, по умолчанию UTF-8.</li>

	<li><b>$GLOBALS['htracer_mysql']</b>     	&mdash; работать ли с MySQL, по умолчанию `false`, также может быть true, false или `forced` (при значении `forced` Htracer сам подключается к MySQL).</li>
	<li><b>$GLOBALS['htracer_mysql_login']</b>  &mdash; Логин пользователя MySQL. Используеться только в формированном режиме</li>
	<li><b>$GLOBALS['htracer_mysql_pass']</b>   &mdash; Пароль пользователя MySQL. Используеться только в формированном режиме</li>
	<li><b>$GLOBALS['htracer_mysql_host']</b>   &mdash; Хост MySQL. Используеться только в формированном режиме.</li>
	<li><b>$GLOBALS['htracer_mysql_dbname']</b> &mdash; Имя БД MySQL.</li>
	<li><b>$GLOBALS['htracer_mysql_link']</b>	&mdash; false, ли линк на MySQL ресурс, который используется для работы с MySQL. По умолчанию false при форсированном режиме определяеться автоматически. Задание может требоваться, когда сайт использует одновременно несколько БД MySQL</li>

	<li><b>$GLOBALS['insert_keywords_params']</b> &mdash; параметр params при вызове insert_keywords и insert_keywords_cb по умолчанию. Нужен если эта функция вызываеться с помощью callback, например, ob_start("insert_keywords"). <a href="#insert_keywords_params">Подробнее</a></li>
	<li><b>$GLOBALS['insert_keywords_where']</b> &mdash; параметр where при вызове insert_keywords и insert_keywords_cb по умолчанию. Нужен если эта функция вызываеться с помощью callback, например, ob_start("insert_keywords"). <a href="#insert_keywords_where">Подробнее</a></li>
	<li><b>$GLOBALS['htracer_cash_days']</b> &mdash; Сколько дней актуалаел кеш. По умолчанию 5. Целое число (7) или число с плавающей точкой (0.12)</li>
	<li><b>$GLOBALS['htracer_trace']</b>    &mdash; записывать ли переходы с поисковиков. Этот параметр будет иметь силу, только если его задать до подключения библиотеки. </li>
	<li><b>$GLOBALS['htracer_doubles_not_first_serp_page']</b> &mdash; Переходы со второй и более страницы выдачи поисковых систем считаютаются двойными</li>
	<li><b>$GLOBALS['htracer_trace_double_comercial_query']</b> &mdash; Переходы по коммеречским запросам (купить, цены и пр.) считаютаются двойными</li>

	<li><b>$GLOBALS['htracer_not_plain_tags']</b> &mdash; Ассоциативный массив с тегами внутри которых не ставятся контекстные ссылки. Например, чтобы разрешить расстановку в теге B после подключения файла HTracer напишите unset($GLOBALS['htracer_not_plain_tags']['b']); unset($GLOBALS['htracer_not_plain_tags']['strong']); Чтобы запретить в теге MyTag напишите: $GLOBALS['htracer_not_plain_tags']['mytag']=true;</li>
	
</ul>	
<br /><br />

<h2>О работе приложения</h2>
1. <b>Условный рандом</b>. Любая "случайная" величина генерируемая программиой не является ни случайной ни псевдослучайной.<br />
Например, "случайный ключевик" это "условнослучайный ключевик". Она зависит от страницы и места на странице, 
но постоянна для каждого обновления страницы, если число записей о переходах на страницу не увеличиться в 1.5 раза.<br />
Для пользователя скрипта Htracer (вебмастера, программиста) число ведет себя как случайное. Т.е. можно писать the_rand_key() сколько угодно раз и не бояться что ключевики будут одинаковыми или зацикленными.<br />
С другой стороны для Поискового робота или посетителя сайта эта величина будет одинаковой при обновлении страницы и не будет случайной<br /> 
<br />
2. <b>Нормализация регистра</b>. Скрипт определяет имена собственные и аббревеатуры и нормализует их регистр. 
"музеи одессы"=>"музеи Одессы". Скрипт успешно определяет около 90% имен собственных в том числе и неизвестные ему  
"музеи редконазванска"=>"музеи Редконазванска","улица редконазванская"=>"улица Редконазванская".<br />
<br />
<br /><br />

<h2>Описание функций</h2>
Большинство функций, в большинстве случаев не нуждаються в параметрах. Поэтому не пугайтесь их числа.
<br /><br />
<b><big><big>get_rand_key</big></big></big></i></b>($URL=false,$Sanitarize=true,$UpCaseFirst=true,$Encoding=false)<br />
Возвращает случайный ключевик страницы с URL=$URL. Если $URL не задан то возвращается ключевик для текущей страницы.<br />
<b>$Sanitarize</b> - санитараризация (приведение в номальный вид ключевика). По умолчанию true. <br />
<b>$UpCaseFirst</b> - Преобразовывать ли первый символ в верхний регистр. По умолчанию true.<br />
<b>$Encoding</b> - кодировка возвращаемого результата, по умолчанию равно $GLOBALS['htracer_encoding']<br /><br />
Примеры использования:<br />
<i>&lt;?php echo '&lt;img src="1.png" alt="'.get_rand_key().'">';?><br />
&lt;?php echo '&lt;a href="http://site1.ru/page1.html" title="'.get_rand_key('http://site1.ru/page1.html').'">';?><.i><br /><br />
</i>
<b><big><big>the_rand_key</big></big></big></b>($URL=false,$Sanitarize=true,$UpCaseFirst=true,$Encoding=false)<br />
Тоже самое что и echo get_rand_key();<br />
Примеры использования:<br /><i>
&lt;img alt="&lt;?php the_rand_key();?>" src="1.php"><br />
&lt;a title=&lt;?php the_rand_key('http://site1.ru/page1.html');?>" href="http://site1.ru/page1.html"></i><br /><br />


<b><big><big>get_meta_keywords</big></big></big></i></b>($Razd=', ',$Encoding=false)<br />
Возвращает содержимое META Keywords. Выводит короткий список ключевиков этой страницы. $Razd - это символы которые между ключевиками
<br /><br />

<b><big><big>the_meta_keywords</big></big></big></i></b>($Razd=', ',$Encoding=false)<br />
Выводит содержимое META Keywords.<br />
Примеры использования:<br />
<i>&lt;HEAD>&lt;meta name="keywords" content="&lt;?php the_meta_keywords() ?>">&lt;/HEAD></i>
<br /><br />

<b><big><big>get_meta_keys_tag</big></big></big></i></b>($Razd=', ',$Encoding=false)<br />
Возвращает содержимое META Keywords. Вместе с самими тегом<br /><br />

<b><big><big>the_meta_keys_tag</big></big></big></i></b>($Razd=', ',$Encoding=false)<br />
Выводит содержимое META Keywords. Вместе с самими тегом<br />
Примеры использования:<br />
<i>&lt;HEAD>&lt;?php the_meta_keys() ?>&lt;/HEAD></i>
<br /><br />


<b><big><big>insert_keywords</big></big></big></i></b>($html,$where='img_alt+a_title+meta_keys',$params=false)<br />
Возвращает содержимое $html в котором в необходимые места были вставлены ключевые слова. <br />
<b>$html</b> - исходный текст. Может быть целой страницей, либо каким-то ее куском. Для вставки метакейвордс необходимо, чтобы оба и открывающей тег HEAD и закрывающий тег HEAD присутствовали в этом отрезке.<br />
<b>$where</b> - места в которых нужно соверщить замены, через плюс. 
<a name="insert_keywords_where"></a>
<ul>
	<li><i>img_alt</i> - альты картинок</li>
	<li><i>a_title</i> - титлы ссылок</li>
	<li><i>meta_keys</i> - мета кейфорд </li>
</ul>
<b>Примеры:</b> <br />
&nbsp;&nbsp;&nbsp;&nbsp;<i>a_title+meta_keys</i> — титлы ссылок и кейворды<br />
&nbsp;&nbsp;&nbsp;&nbsp;<i>a_title+img_alt</i> — титлы ссылок и альты картинок<br />
<br />
<a name="insert_keywords_params"></a>
<b>$params</b> - ассоциативный массив или GET-образная строка ("key1=val1&key2=val2&key3=val3") c параметрами:
<ul>
	<li><i>procent</i> - вероятность в процентах простановки ключа, по умолчанию 100</li>
	<li><i>upcase</i> - в верхний регистр первую букву, по умолчанию true (1)</li>
	<li><i>sanitarize</i> -  см. get_rand_key, по умолчанию true (1)</li>
	<li><i>rewrite</i> -  перезаписывать ли параметры, по умолчанию false (0).</li>
	<li><i>rewrite0</i> -  перезаписывать ли параметры если они пустые, по умолчанию true (1).</li>
<li>
	Также эти параметры можно задавать раздельно для титлов ссылок, альтов картинок, и мета кейвородс.
	<ul>
		<li><i>meta_keys_rewrite</i></li>
		<li><i>meta_keys_rewrite0</i></li>
		<li><i>img_alt_procent</i></li>
		<li><i>img_alt_upcase</i></li>
		<li><i>img_alt_sanitarize</i></li>
		<li><i>img_alt_rewrite</i></li>
		<li><i>img_alt_rewrite0</i></li>
		<li><i>a_title_procent</i></li>
		<li><i>a_title_upcase</i></li>
		<li><i>a_title_sanitarize</i></li>
		<li><i>a_title_rewrite</i></li>
		<li><i>a_title_rewrite0</i></li>
	</ul>
</li>
</ul>
<b>Примеры:</b> <br />
&nbsp;&nbsp;&nbsp;&nbsp;<i>rewrite=1</i> — перезаписывать альты, титлы и метакейвордс, даже если есть.<br />
&nbsp;&nbsp;&nbsp;&nbsp;<i>a_title+img_alt</i> — титлы ссылок и альты картинок<br />
<br />
<br />
<b>Диапозоны текста:</b>
Чтобы ограничить диапозон в котором будет происходить замена в функции insert_keywords обрамите его <i>&lt;!--h_tracer--></i> и <i>&lt;!--/h_tracer--></i>. Примеры:
<i>
<br />  Здесь замен нет &lt;!--h_tracer--> здесь замены есть &lt;!--/h_tracer--> здесь замен нет
<br />  Здесь замены есть &lt;!--/h_tracer--> здесь замен нет
<br />  Здесь замен нет &lt;!--h_tracer--> здесь замены есть &lt;!--/h_tracer--> здесь замен нет &lt;!--h_tracer--> здесь замены есть
<br />  Здесь замены есть &lt;!--/h_tracer--> здесь замен нет &lt;!--h_tracer-->  здесь есть замены
</i>
<br /><br />

<b><big><big>insert_keywords_cb</big></big></big></i></b>($html)<br />
Тоже самое, что и insert_keywords, но только с одним параметром, остальные два параметры считывает из $GLOBALS['insert_keywords_where'] и $GLOBALS['insert_keywords_params']. Нужна для callback вызовов.

<br /><br />

<a name="key_cloud"></a>
<b><big><big>get_keys_cloud</big></big></big></i></b>($params=false)<br />
<b>Примеры:</b> <br />
&nbsp;&nbsp;&nbsp;&nbsp;<i>&lt;?php echo get_keys_cloud();?></i> &mdash; Облако тегов по умолчанию <br />
&nbsp;&nbsp;&nbsp;&nbsp;<i>&lt;?php echo get_keys_cloud("style=10/30");?></i> &mdash; Облако мз 10 случайных ссылок из 30 максимальных<br />
&nbsp;&nbsp;&nbsp;&nbsp;<i>&lt;?php echo get_keys_cloud("style=ul_list 5/50");?></i> &mdash; Список из 5 случайных ссылок из 50 максимальных<br />
<br />

Возвращает облако ключевых слов. В зависимости от параметра shablon может формировать и простой список.<br />
$params  &mdash; ассоциативный массив или GET-образная строка ("<i>parameter1=value1&parameter2=value2&parameter3=value3</i>") 
<ul>
	<li><b>style</b> &mdash; Стили разделенные пробелом (нужны для того, чтобы быстрее вводить параметры), по умолчанию пустая строка, например "<i>style=ul_list 5/50</i>" - ненумерованный список из случайных 5 ссылок, выбранных из 50 максимальных    
		<br />&nbsp;&nbsp;&nbsp;&nbsp;ul_list &mdash; не нумерованный список
		<br />&nbsp;&nbsp;&nbsp;&nbsp;ol_list &mdash; нумерованный список
		<br />&nbsp;&nbsp;&nbsp;&nbsp;br_list &mdash; список через br
		<br />&nbsp;&nbsp;&nbsp;&nbsp;N/M     &mdash; где N и M целые числа, значит выбрать случайно N страниц из M максимальных (аналог count=M, procent=100 * (N/M))
	</li>
	<li><b>count</b>   &mdash; число ссылок, по умолчанию 20</li>
	<li><b>minsize</b> &mdash; минимальный font-size (CSS) в процентах, по умолчанию 70</li>
	<li><b>maxsize</b> &mdash; максимальный font-size (CSS) в процентах, по умолчанию 180</li>
	<li><b>title</b>   &mdash; название, например, "<i>title=&lt;b>Смотрите также&lt;/b></i>", по умолчанию пустая строка</li>
	<li><b>shablon</b> &mdash;  шаблон, по умолчанию равен <i>&lt;a href="_HREF_" style="font-size:_SIZE_%" title="_KEY2_">_KEY_&lt;/a></i>
		<br />&nbsp;&nbsp;&nbsp;&nbsp;_HREF_ &mdash; URL ссылки
		<br />&nbsp;&nbsp;&nbsp;&nbsp;_SIZE_ &mdash; размер 
		<br />&nbsp;&nbsp;&nbsp;&nbsp;_KEY_ &mdash; самый часточный ключевик, 
		<br />&nbsp;&nbsp;&nbsp;&nbsp;_KEY2_ &mdash; второй по частотности ключевик
		<br />&nbsp;&nbsp;&nbsp;&nbsp;_AMP_ &mdash; амперсант (&), единственный недопустимый символ 
	</li>
	<li><b>procent</b>		&mdash; вероятность выпадения ссылки, по умолчанию 100. Число выводимых ссылок не случайно. Т.е. если Вы выберите $params="count=100&procent=5", то число ссылок будет всегда равно 5, но на каждой странице это будут 5 разных ссылок (если, конечно, на сайте есть 100 страниц).</li>
	<li><b>mode</b>  		&mdash; от чего зависит размер ссылки. По умолчанию E (сбалансированая оценка). Также может приминмать значения N (число переходов на страницу) и M (число переходов на страницу по максимальному ключу)</li>
	<li><b>sort</b>   		&mdash; сортировать ли по алфавиту, по умолчанию true(1).</li>
	<li><b>upcase</b>		&mdash; переводить ли первый символ в верхний регистр, По умолчанию true(1)</li>
	<li><b>sanitarize</b>	&mdash; производить ли санитаризация строки, По умолчанию true(1) </li>
	<li><b>spacer</b>		&mdash; разделитель ссылок. По умолчанию ' '(пробел)</li>
	<li><b>replace</b>		&mdash; Замены, производимой в анкорах ссылок, разделенные '+' (Например, "Одесса=Москва+в Одессе=в Москве"), по умолчанию пустая строка</li>
	<li><b>pre</b>   		&mdash; добавить перед облаком, по умолчанию пустая строка</li>
	<li><b>post</b>  		&mdash; добавить после облака, по умолчанию пустая строка</li>
	<li><b>this</b>  		&mdash; допустима ли ссылка на текущую страницу, по умолчанию нет</li>
	<li><b>urlstart</b>  	&mdash; Если этот параметр указан, то в облаке будут только те страницы, которые начинаються с него.
									Этот параметр можно использовать, чтобы в разных разделах выводить разные облака.  
									Например, get_keys_cloud("urlstart=/category/"). 
									Писать нужно без http:// и домена сайта. 
									Вместо символа '&' нужно писать _AMP_  
	
	</li>
</ul>
<b>Примеры:</b> <br />
&nbsp;&nbsp;&nbsp;&nbsp;<i>&lt;?php echo get_keys_cloud();?></i> &mdash; Облако тегов по умолчанию <br />
&nbsp;&nbsp;&nbsp;&nbsp;<i>&lt;?php echo get_keys_cloud("style=ul_list 5/50&title=&lt;b>Смотрите также:&lt;/b>");?></i> &mdash; Список 5 случайных ссылок из 50 максимальных<br />
&nbsp;&nbsp;&nbsp;&nbsp;<i>&lt;?php echo get_keys_cloud("pre=&lt;div id="cloud">&post=&lt;/div>");?></i> &mdash; Облако тегов в диве
<b>Вызов через комментарии:</b> <br />
&nbsp;&nbsp;&nbsp;&nbsp;<i>&lt;!--the_keys_cloud--></i> &mdash; Облако тегов по умолчанию<br />
&nbsp;&nbsp;&nbsp;&nbsp;<i>&lt;!--the_keys_cloud style=ul_list 5/50--></i> список 5 ссылок из 50<br />
&nbsp;&nbsp;&nbsp;&nbsp;<i>&lt;!--the_keys_cloud minsize=70&amp;maxsize=170--></i><br />

<br /><br />

<b><big><big>get_keys_cloud_subdir</big></big></big></i></b>($params="",$MinLinks=5)<br />
$params - параметры такие-же как и у get_keys_cloud <br />
$MinLinks - минимальное число ссылок в облаке<br />
Аналог get_keys_cloud, только сначала пытаеться вернуть облако для текущей директории. <br />
Если число ссылок в нем меньше $MinLinks или мы находимся не в поддиректории то возвращает общее облако<br />
Например, для страницы http://site.ru/dir/page1.html эта функция попытаеться вывести в облаке только страницы начинающиеся с http://site.ru/dir/ Если нее не получиться, то она выведет все страницы.

<br /><br />
<a name="seo_title"></a>
<b><big><big>HT_FormTitle</big></big></big></i></b>($Temp,$MaxWords=7)<br />
Возвращает титл для текущей страницы <br />
$Temp &mdash; исходный титл страницы. Используеться, чтобы функция не возвращала пустой результат.<br />
Если функция не может вернуть результат (например, если переходов в БД нет), то возвращает $Temp.<br />
$MaxWords &mdash; максимальное число слов в титле<br />

<br />

<b>Пример:</b> <br />
&nbsp;&nbsp;&nbsp;&nbsp;<i>&lt;title>&lt;?php echo HT_FormTitle('Музеи одессы');?> | сайт об Одессе&lt;/title></i> &mdash; Облако тегов по умолчанию <br />
<br />

</body>
</html>
